@{ var localTabViewModel = Tab; }

<button class="luth_polymorphic-tab luth_button luth_unselectable @IsActiveCssClass @localTabViewModel.TabGroup.GetDynamicCss(localTabViewModel) @GetIsBeingDraggedCssClassString() @CssClassString"
		style="@GetDraggableCssStyleString() @CssStyleString"
		id="@HtmlId"
        title="@localTabViewModel.TitleVerbose"
		@ref="_tabButtonElementReference"
		@onclick:stopPropagation="true"
		@onclick="e => localTabViewModel.TabGroup.OnClickAsync(localTabViewModel, e)"
		@onmousedown:stopPropagation="true"
		@onmousedown:preventDefault="true"
        @onmousedown="HandleOnMouseDownAsync"
        @onmouseup="HandleOnMouseUp"
        @onmouseout="HandleOnMouseOutAsync"
		@oncontextmenu:preventDefault="true"
		@oncontextmenu:stopPropagation="true"
		@oncontextmenu="e => ManuallyPropagateOnContextMenu(e, localTabViewModel)">

	<span>@localTabViewModel.Title</span>

	@if (ShouldDisplayCloseButton)
	{
		<button class="luth_button luth_button-close"
	            @onclick:stopPropagation="true"
	            @onclick="CloseTabOnClickAsync">
	        
	        @{
	        	var iconDriver = new IconDriver(
					AppOptionsStateWrap.Value.Options.IconSizeInPixels,
					AppOptionsStateWrap.Value.Options.IconSizeInPixels);
	        }
	        @IconCloseFragment.Render(iconDriver)
    	</button>
	}
</button>