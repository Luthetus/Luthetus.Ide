@using System.Text
@using Luthetus.Common.RazorLib.Keyboards.Models
@using Luthetus.TextEditor.RazorLib.TextEditors.Models
@using Luthetus.TextEditor.RazorLib.TextEditors.Models.Internals
@using Luthetus.TextEditor.RazorLib.Rows.Models
@using Luthetus.TextEditor.RazorLib.Htmls.Models

@{ var renderBatch = TextEditorViewModelDisplay._activeRenderBatch; }

@if (renderBatch is not null)
{
	_footerDriver.GetRenderFragment(renderBatch);
	    
	<div class="luth_te_text-editor-footer @TextEditorService.ThemeCssClassString">
	    <div class="luth_te_text-editor-footer-listing">
	        @{
	            var model = _footerDriver._renderBatch.Model;
	            var viewModel = _footerDriver._renderBatch.ViewModel;
	            var options = _footerDriver._renderBatch.Options;
	
	            if (model is not null && viewModel is not null)
	            {
	                if (!string.IsNullOrWhiteSpace(model.FileExtension))
	                {
	                    <div class="luth_te_text-editor-footer-entry">
	                        @model.FileExtension
	                    </div>
	                }
	
	                <div class="luth_te_text-editor-footer-entry">
	                    <div class="luth_te_text-editor-footer-name-value-pair">
	                        <div class="luth_te_text-editor-footer-name">
	                            length:
	                        </div>
	                        <div class="luth_te_text-editor-footer-value"
	                             style="@_footerDriver.StyleMinWidthFromMaxLengthOfValue(model.DocumentLength)">
	                            @($"{model.DocumentLength}")
	                        </div>
	                    </div>
	
	                    <div class="luth_te_text-editor-footer-name-value-pair">
	                        <div class="luth_te_text-editor-footer-name">
	                            lines:
	                        </div>
	                        <div class="luth_te_text-editor-footer-value"
	                             style="@_footerDriver.StyleMinWidthFromMaxLengthOfValue(model.LineCount)">
	                            @($"{model.LineCount}")
	                        </div>
	                    </div>
	                </div>
	
	                <div class="luth_te_text-editor-footer-entry">
	                    <div class="luth_te_text-editor-footer-name-value-pair">
	                        <div class="luth_te_text-editor-footer-name">
	                            Ln:
	                        </div>
	
	                        @{
	                            var rowNumber = viewModel.PrimaryCursor.LineIndex + 1;
	                        }
	
	                        <div class="luth_te_text-editor-footer-value"
	                             style="@_footerDriver.StyleMinWidthFromMaxLengthOfValue(model.LineCount)">
	                            @($"{rowNumber}")
	                        </div>
	                    </div>
	
	                    <div class="luth_te_text-editor-footer-name-value-pair">
	                        <div class="luth_te_text-editor-footer-name">
	                            Col:
	                        </div>
	
	                        @{
	                            var columnNumber = viewModel.PrimaryCursor.ColumnIndex + 1;
	                        }
	
	                        <div class="luth_te_text-editor-footer-value"
	                             style="@_footerDriver.StyleMinWidthFromMaxLengthOfValue(model.MostCharactersOnASingleLineTuple.lineLength)">
	                            @($"{columnNumber}")
	                        </div>
	                    </div>
	
	                    <div class="luth_te_text-editor-footer-name-value-pair">
	                        <div class="luth_te_text-editor-footer-name">
	                            Pos:
	                        </div>
	
	                        @{
	                            var positionNumber = _footerDriver.GetPositionNumber(model, viewModel);
	                        }
	
	                        <div class="luth_te_text-editor-footer-value"
	                             style="@_footerDriver.StyleMinWidthFromMaxLengthOfValue(model.DocumentLength)">
	                            @($"{positionNumber}")
	                        </div>
	                    </div>
	                </div>
	
	                <div class="luth_te_text-editor-footer-entry">
	                    @if (model.OnlyLineEndKind == LineEndKind.Unset)
	                    {
	                        <text>has:unset </text>
	                    }
	                    else
	                    {
	                        <text>has:@model.OnlyLineEndKind.AsFriendlyName() </text>
	                    }
	
	                    use:
	                    <select @onchange="_footerDriver.SelectRowEndingKindOnChange">
	                        @foreach (var rowEndingKind in LineEndKind.LineFeed.GetRowEndingsUserAllowedToUse())
	                        {
	                            <option value="@rowEndingKind.ToString()"
	                                    selected="@(model.LineEndKindPreference == rowEndingKind)">
	                                @rowEndingKind.AsFriendlyName()
	                            </option>
	                        }
	                    </select>
	                </div>
	            }
	            else
	            {
	                <div class="luth_te_text-editor-footer-entry luth_te_text-editor-footer-file-sizing">
	                    @if (model is null)
	                    {
	                        <div>The @nameof(TextEditorModel) was null</div>
	                    }
	                    else if (viewModel is not null)
	                    {
	                        <div>The @nameof(TextEditorViewModel) was null</div>
	                    }
	                </div>
	            }
	        }
	    </div>
	</div>
}
